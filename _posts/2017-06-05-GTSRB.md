---
layout: post
title: Traffic Sign Recognition using Convelutional Neural Network
excerpt: "Machine Learning - Image Classification"
modified: 04/05/2017, 1:27
tags: [CNN, Caffe]
comments: true
category: blog
---

## 1. Data Description
This dataset comes from [German Traffic Sign Recognition Benchmark](http://benchmark.ini.rub.de/?section=gtsrb&subsection=dataset), which contains 39209 images in 43 folders and each folder contain one same kind of traffic sign images taking from different places and at different distance. And the size of the images varies from 30 * 30 pixel to larger than 100 * 100 pixel. Here is how it looks like:
![dataset](images/GTSRB/Dataset.png)

## 2. Problem definition

Problem type: Image classification  
Method: Convolutional Neural Network(CNN)  
Software: caffe  

Task:
* i. Transfer original data image from .ppm to .jpg
* ii. Using .jpg to create .lmdb data file
* iii. Compute image mean file .binaryproto using .lmdb file 
* iv. Build network construction 
* v. Train network
* vi. Test the network with new images
* vii. Visualize the test result

## 3. Data Preparation
#### 3.1 Transfer original data image from .ppm to .jpg
~~~ ruby
for f in range(0,43):
    # save folder name as the format: 00042
    folder = format(f, '05d')
    csv_path = image_root + folder + '/GT-' + folder + '.csv'
    csv = pd.read_csv(csv_path, sep= ';')
    ppm_name = csv['Filename']
    # len(ppm_name) refer to how many .ppm images in each folder
    for i in range(0, len(ppm_name)):
        # select 1/3 as testing image
        if i % 3 == 0:
            im = Image.open(image_root + folder + '/' + csv['Filename'][i])
            im.save('image_path_name' + 'TestJPG/' + format(f, '02d') + '_' +
                    csv['Filename'][i].replace('ppm', 'jpg'))
        else:
            im = Image.open(image_root + folder + '/' + csv['Filename'][i])
            im.save('image_path_name' + 'TrainJPG/' + format(f, '02d') + '_' +
                    csv['Filename'][i].replace('ppm', 'jpg'))
~~~
